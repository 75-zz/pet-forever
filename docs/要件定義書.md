# 犬のメモリアル動画カレンダー Webアプリ 要件定義書

## 1. 目的
愛犬の動画・画像を毎日鑑賞しつつ、カレンダーと共に思い出を振り返る Web アプリを提供する。

- 動画：1週間ごとに固定（最大 月4本）
- 動画→画像スライド（複数）の順でループ再生
- カレンダーは必ず最前面表示（1日／1か月切替）
- ユーザーが UI/表記/再生設定を自由にカスタマイズ
- オブジェクト指向 UI/UX・デザインシステム対応

---

## 2. 対象範囲（スコープ）
- PC／タブレット／スマホ対応ブラウザ
- ローカルでメディアを管理（初期版はクラウド無し）
- PWAサポート（アプリ風起動）

---

## 3. UIレイヤー仕様
### レイヤー構造
| Z-index | レイヤー内容 |
|---|---|
| 200 | 操作UI（設定・全画面） |
| 100 | カレンダー（1日 / 1か月） |
| 10 | メディア（動画 or 画像×2） |
| 0 | 背景 |

### カレンダー表示条件
- 白文字＋黒ドロップシャドウ
- 左上／右上／左下／右下／上中央／下中央から選択
- 曜日・表記方法・年号 ON/OFF
- 日本語／英語切替
- 日曜／月曜開始選択

---

## 4. 再生ロジック
### 週替わり動画
- 週区切り：月曜（設定で日曜可）
- 第5週は「第4週継続 or 第1週に戻る」

### ラウンド制御
- 動画（10〜20秒） → 画像スライド×N（2〜4回）

### 画像表示ルール
- 2枚コラージュ
- ランダム角度：-10°〜+10°
- ランダム位置：X±24〜80px / Y±48〜120px
- スケール 60%〜90%

**多様性制御**
- 直近履歴除外（K=20）
- タグ分散（連続抑止）
- 希少度ブースト（出番が少ない写真を優先）

---

## 5. 設定項目
|項目|内容|
|---|---|
言語 | 日本語 / 英語
カレンダー | 1日 / 1か月
週開始 | 日曜 / 月曜
動画長さ | 10〜20秒 or 固定
画像回数 | 2〜4枚
画像ランダム | 角度 / 位置 / 拡大率
音声 | ON/OFF / ボリューム
背景 | 単色（黒推奨）
記念日設定 | アイコン/色強調

---

## 6. メディア管理
- ドラッグ/選択で追加
- タグ付け
- 週番号に動画を割り当て
- 設定のインポート/エクスポート（JSON）

---

## 7. 技術要件
- TypeScript + Next.js
- Tailwind + デザイントークン
- Zustand state / IndexedDB
- PWA / Workbox
- date-fns-tz

---

## 8. パフォーマンス要件
|項目|基準|
|---|---|
初期表示 | 2.5秒以内
切替ラグ | 1フレーム以内
動画推奨 | 1080p / 30fps

---

## 9. 拡張予定
- Google Photos連携
- 音楽追加
- 顔位置自動補正
- 記念日スライド演出
